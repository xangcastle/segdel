{% extends "app/index.html" %}

{% comment %}{% block static-navbar %}{% endblock static-navbar %}

{% block aside-bar %}{% endblock aside-bar %}
{% endcomment %}
{% block breadcrums %}
<div class="row">
    <div class="col-sm-12">
        <div class="page-title" style="margin-bottom: 0px;">
            <h1>Cobranza al Cliente {{ cliente.nombre }}<small></small></h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-money"></i></a></li>
                <li><a href="../cobranza">Cobranza</a></li>
                <li class="active">Cliente</li>
            </ol>
        </div>
    </div>
</div>
{% endblock breadcrums %}

{% block cuerpo %}
<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-card recent-activites">
            <!-- Start .panel -->
            <div class="panel-heading">
                <h4 class="panel-title">Datos Generales</h4>
                <div class="panel-actions">
                    <a href="#" class="panel-action panel-action-toggle" data-panel-toggle></a>
                    <a href="#" class="panel-action panel-action-dismiss" data-panel-dismiss></a>
                </div>
            </div>
            <div class="panel-body">
                <input id="clienteid" type="hidden" value="{{ cliente.id }}">
                <div class="row">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Identificación:</label>
                        <div class="col-sm-10">
                            <input class="form-control" disabled="true" placeholder="identificacion:" type="text" value="{{ cliente.identificacion }}">
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="row">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Nombre:</label>
                        <div class="col-sm-10">
                            <input class="form-control" disabled="true" placeholder="Nombre:" type="text" value="{{ cliente.nombre }}">
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="row">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Telefono:</label>
                        <div class="col-sm-10">
                            <input class="form-control" disabled="true" placeholder="Telefono:" type="text" value="{{ cliente.telefono }}">
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="row">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Dirección:</label>
                        <div class="col-sm-10">
                            <input class="form-control" disabled="true" placeholder="Dirección:" type="text" value="{{ cliente.direccion }}">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-sm-6">
        <div class="panel panel-card recent-activites">
            <!-- Start .panel -->
            <div class="panel-heading">
                <h4 class="panel-title">Documentos x Cobrar</h4>
                <div class="panel-actions">
                    <a href="#" class="panel-action panel-action-toggle" data-panel-toggle></a>
                    <a href="#" class="panel-action panel-action-dismiss" data-panel-dismiss></a>
                </div>
            </div>
            <div class="panel-body">
                <div class="nano has-scrollbar" style="height:440px">
                    <div class="nano-content pad-all" tabindex="0" style="right: -17px;">
                        {% for factura in facturas %}
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <div class="col-sm-2"><strong>No Doc:</strong> </div>
                                    <div class="col-sm-3">{{ factura.nodoc }}</div>
                                    <div class="col-sm-3"><strong>Saldo:</strong> </div>
                                    <div class="col-sm-4">{{ factura.saldo_factura }}</div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><strong>Emisión:</strong></div>
                                    <div class="col-sm-3">{{ factura.fecha }}</div>
                                    <div class="col-sm-3"><strong>Vencimiento:</strong></div>
                                    <div class="col-sm-4">{{ factura.fecha_vence }}</div>
                                </div>
                                <div class="form-group">

                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-3d btn-success">Abonar</button>
                                    <button class="btn btn-3d btn-primary">Cancelar</button>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-6">
        <div class="panel panel-card recent-activites ">
            <!-- Start .panel -->
            <div class="panel-heading">
                <h4 class="panel-title">Comentarios</h4>
                <div class="panel-actions">
                    <a href="#" class="panel-action panel-action-toggle" data-panel-toggle></a>
                    <a href="#" class="panel-action panel-action-dismiss" data-panel-dismiss></a>
                </div>
            </div>
            <div class="panel-body">
                <div class="nano has-scrollbar" style="height:240px">
                    <div class="nano-content pad-all" tabindex="0" style="right: -17px;">
                        <div id="conten-comentarios"></div>
                    </div>
                </div>
                <hr>
                <div class="form-horizontal">
                    <div class="form-group">
                        <div class="col-xs-12">
                            <textarea id="post-comment" name="post-comment" rows="4" placeholder="Su comentario aquí.." class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-xs-12">
                            <button id="comentar" class="btn btn-effect-ripple btn-primary">Enviar comentario</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-card recent-activites">
            <!-- Start .panel -->
            <div class="panel-heading">
                <h4 class="panel-title">Visitas / Promesas de pago / Gestiones</h4>
                <div class="panel-actions">
                    <a href="#" class="panel-action panel-action-toggle" data-panel-toggle></a>
                    <a href="#" class="panel-action panel-action-dismiss" data-panel-dismiss></a>
                </div>
            </div>
            <div class="panel-body">

            </div>
        </div>
    </div>
</div>

{% endblock cuerpo %}
{% block scripts-block %}
    <script src="/static/app/js/data-tables/jquery.dataTables.js"></script>
    <script src="/static/app/js/data-tables/dataTables.tableTools.js"></script>
    <script src="/static/app/js/data-tables/dataTables.bootstrap.js"></script>
    <script src="/static/app/js/data-tables/dataTables.responsive.js"></script>
    <script src="/static/app/js/data-tables/tables-data.js"></script>   
    <script>
    $(document).ready(function () {
        $("#comentar").on('click',function () {
            var comment= $("#post-comment").val();
            var cliente = $("#clienteid").val();
            $.ajax({
                url:"../add_comentario_cliente/",
                type:"POST",
                dataType: 'json',
                data: {comentario:comment,id_cliente:cliente},
                success: function (result) {
                    data=result[0];
                    $("#post-comment").val("");
                    cargarComentarios();
                }
            });
        })
        cargarComentarios();
    })
    function cargarComentarios() {
        $.ajax({
            url:"../get_comentario_cliente/?id={{ cliente.id }}",
            type:"GET",
            success:function (result) {
                $("#conten-comentarios").empty().html(result);
            }
        });
    }
    </script>
{% endblock %}